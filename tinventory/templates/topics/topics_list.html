{% extends "core/base.html" %}
{% load widget_tweaks %}
{% load mptt_tags %}

{% block title %}Topics {% endblock %}

{% block header %}Topics

     <div class="pull-right dropdown">
        <button class="btn btn-success dropdown-toggle" type="button" data-toggle="dropdown">
        <span class="glyphicon glyphicon-plus-sign"></span>  Add a New Resource
        <span class="caret"></span></button>
         
        <ul class="dropdown-menu">
            <li><a href="{% url 'resource-add-topic-base' type='link' %}">Add a new link</a></li>
            <li><a href="{% url 'resource-add-topic-base' type='file' %}">Add a new file</a></li>
        </ul>
     </div>

{% endblock %}

{% block content %}
    
    {% for n in topic_list %}
    
        {% if n.is_root_node %}
        
            {% cycle '<div class="row"><div class="list-group list-group-root col-md-6">' '<div class="list-group list-group-root col-md-6">' %}
        
            <h3>{{n.title}}</h3>
            
            {% recursetree n.get_descendants %}
        
                
                <a href="{% url 'topic-detail' slug=node.slug %}" class="list-group-item list-lvl-{{node.level}} justify-content-between">
                <strong>{{ node.title }}</strong>
                
                {% if node.description %}
                    <br/><span class="small">{{node.description }}</span>
                {% endif %}
                
                <span class="badge badge-default badge-pill">
                {{ node.resources|length }}    
                </span>
                
                </a>
                
                {{children}}
            
            {% endrecursetree %}
            
            {% cycle '</div>' '</div></div>' %}
            
        {% endif %}
        
    {% endfor %}
    
{% endblock %}